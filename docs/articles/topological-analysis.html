<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Topological Analysis • robber</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Topological Analysis">
<meta property="og:description" content="robber">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">robber</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/topological-analysis.html">Topological Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Chabert-Liddell">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="topological-analysis_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Topological Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Chabert-Liddell/robber/blob/master/vignettes/topological-analysis.Rmd"><code>vignettes/topological-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>topological-analysis.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Chabert-Liddell/robber">robber</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>In what follows, we will use <code>robber</code> to illustrate how different set of parameters of block models, representing different mesoscale structure of networks has an influence on the robustness of bipartite ecological networks. By doing so, we will review the main functions of the package.</p>
<div id="robustness-of-real-bipartite-ecological-networks" class="section level1">
<h1 class="hasAnchor">
<a href="#robustness-of-real-bipartite-ecological-networks" class="anchor"></a>Robustness of real bipartite ecological networks</h1>
<p>We load 3 different networks, a host-parasite, a seed-dispersal and a pollination’s one.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hostparasite"</span>, package <span class="op">=</span> <span class="st">"robber"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"seeddispersal"</span>, package <span class="op">=</span> <span class="st">"robber"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"pollination"</span>, package <span class="op">=</span> <span class="st">"robber"</span><span class="op">)</span></code></pre></div>
<p>They have the following richness and connectance:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Host-Parasite: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">hostparasite</span><span class="op">)</span>, <span class="st">" "</span>, 
           <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">hostparasite</span><span class="op">)</span>, <span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hostparasite</span><span class="op">)</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span>
<span class="co">#&gt; [1] "Host-Parasite: 27 26 0.280626780626781"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Seed Dispersal: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">seeddispersal</span><span class="op">)</span>, <span class="st">" "</span>, 
           <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">seeddispersal</span><span class="op">)</span>, <span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">seeddispersal</span><span class="op">)</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span>
<span class="co">#&gt; [1] "Seed Dispersal: 36 19 0.288011695906433"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Pollination: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pollination</span><span class="op">)</span>, <span class="st">" "</span>, 
           <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">pollination</span><span class="op">)</span>, <span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pollination</span><span class="op">)</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span>
<span class="co">#&gt; [1] "Pollination: 17 51 0.14878892733564"</span></code></pre></div>
<div id="analyzing-the-robustness-of-a-host-parasite-network" class="section level2">
<h2 class="hasAnchor">
<a href="#analyzing-the-robustness-of-a-host-parasite-network" class="anchor"></a>Analyzing the robustness of a host-parasite network</h2>
<p>To compute the empirical robustness, we can use the function <code><a href="../reference/robustness_emp.html">robustness_emp()</a></code> which uses a Monte Carlo simulation. Several options are available to choose the type of extinctions sequences and the way they are computed. The function return a vector of remaining species after each extinction ($fun) and the robustness statistic as the area under the curve ($auc). For example, using the host-parasite network and the default uniform extinction sequence:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">rob_emp_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">hostparasite</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] "empirical"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $method</span>
<span class="co">#&gt; [1] "ordered"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ext_seq</span>
<span class="co">#&gt; [1] "uniform"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $power</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fun</span>
<span class="co">#&gt;  [1] 1.0000000 0.9897436 0.9824359 0.9743590 0.9660256 0.9566667 0.9473077</span>
<span class="co">#&gt;  [8] 0.9366667 0.9251282 0.9138462 0.8997436 0.8826923 0.8671795 0.8510256</span>
<span class="co">#&gt; [15] 0.8350000 0.8185897 0.7988462 0.7752564 0.7534615 0.7257692 0.6939744</span>
<span class="co">#&gt; [22] 0.6498718 0.6061538 0.5546154 0.4952564 0.4130769 0.2841026 0.0000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt;  [1] 0.00000000 0.02094456 0.02691634 0.03274064 0.03647539 0.04035638</span>
<span class="co">#&gt;  [7] 0.04425886 0.04966426 0.05315754 0.05656518 0.06186508 0.06688601</span>
<span class="co">#&gt; [13] 0.06878579 0.07177205 0.07356209 0.07873216 0.08426295 0.08929448</span>
<span class="co">#&gt; [19] 0.09625207 0.09912268 0.10314647 0.11297538 0.12321673 0.13074350</span>
<span class="co">#&gt; [25] 0.14114045 0.15540947 0.16337767 0.00000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc</span>
<span class="co">#&gt; [1] 0.7961776</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "robber"</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_unif</span><span class="op">)</span></code></pre></div>
<p><img src="topological-analysis_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>We can infer a Latent Block Model (LBM) to obtain a sparse parametric representation of the network by regrouping species into blocks. This can be done automatically with this package:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">lbm_param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">hostparasite</span>, ncores <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; $con
#&gt;            [,1]      [,2]
#&gt; [1,] 0.03759168 0.4609027
#&gt; [2,] 0.25445594 0.9500186
#&gt; 
#&gt; $pi
#&gt; [1] 0.6327591 0.3672409
#&gt; 
#&gt; $rho
#&gt; [1] 0.6877587 0.3122413
#&gt; 
#&gt; $nr
#&gt; [1] 27
#&gt; 
#&gt; $nc
#&gt; [1] 26</code></pre>
<p>We can see that the network is divided into 4 blocks (2 groups of hosts and 2 groups of parasites). The network as a classic core-periphery structure, with a very connected core (<span class="math inline">\(.95\)</span>) composed of about a third of the species.</p>
<p>Robber compute the robustness as the the robustness function integrated over all possible networks which arise from the same set of Block Model parameters.</p>
<p>Given the parameters, we can compute the LBM robustness:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">rob_lbm_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="va">lbm_param</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] "lbm"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ext_seq</span>
<span class="co">#&gt; [1] "uniform"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fun</span>
<span class="co">#&gt;  [1] 0.9762710 0.9731198 0.9695500 0.9655062 0.9609254 0.9557362 0.9498579</span>
<span class="co">#&gt;  [8] 0.9431989 0.9356556 0.9271105 0.9174307 0.9064653 0.8940437 0.8799724</span>
<span class="co">#&gt; [15] 0.8640321 0.8459745 0.8255172 0.8023389 0.7760706 0.7462807 0.7124428</span>
<span class="co">#&gt; [22] 0.6738552 0.6294316 0.5771287 0.5123727 0.4236969 0.2806268 0.0000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc</span>
<span class="co">#&gt; [1] 0.808319</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $block</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $method</span>
<span class="co">#&gt; [1] "exact"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $param</span>
<span class="co">#&gt; $param$con</span>
<span class="co">#&gt;            [,1]      [,2]</span>
<span class="co">#&gt; [1,] 0.03759168 0.4609027</span>
<span class="co">#&gt; [2,] 0.25445594 0.9500186</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $param$pi</span>
<span class="co">#&gt; [1] 0.6327591 0.3672409</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $param$rho</span>
<span class="co">#&gt; [1] 0.6877587 0.3122413</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $param$nr</span>
<span class="co">#&gt; [1] 27</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $param$nc</span>
<span class="co">#&gt; [1] 26</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt;  [1] 0.03373627 0.03433957 0.03513052 0.03610450 0.03725673 0.03858187</span>
<span class="co">#&gt;  [7] 0.04007362 0.04172432 0.04352444 0.04546207 0.04752240 0.04968705</span>
<span class="co">#&gt; [13] 0.05193346 0.05423434 0.05655715 0.05886404 0.06111231 0.06325621</span>
<span class="co">#&gt; [19] 0.06525096 0.06706045 0.06866987 0.07010104 0.07141118 0.07260006</span>
<span class="co">#&gt; [25] 0.07319109 0.07082149 0.05674207 0.00000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "robber"</span></code></pre></div>
<p>As we can see the two robustness statistics are very close:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rob_emp_unif</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.7961776</span>
<span class="va">rob_lbm_unif</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.808319</span></code></pre></div>
<p>And we can plot the two curves (the empirical one in blue and the LBM one in black):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_unif</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_lbm_unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="topological-analysis_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Using the above parameters we may simulate networks from the same set of LBM parameters, the black line is the average of all the red dotted line which are the robustness function of particular realization of networks issued from the same distribution:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rob_fun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_lbm.html">simulate_lbm</a></span><span class="op">(</span>con <span class="op">=</span> <span class="va">lbm_param</span><span class="op">$</span><span class="va">con</span>, 
                      pi <span class="op">=</span> <span class="va">lbm_param</span><span class="op">$</span><span class="va">pi</span>, 
                      rho <span class="op">=</span> <span class="va">lbm_param</span><span class="op">$</span><span class="va">rho</span>, 
                      nr <span class="op">=</span> <span class="va">lbm_param</span><span class="op">$</span><span class="va">nr</span>, 
                      nc <span class="op">=</span> <span class="va">lbm_param</span><span class="op">$</span><span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">A</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>unif <span class="op">=</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>,
           dec <span class="op">=</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">A</span>, ext_seq <span class="op">=</span> <span class="st">"decreasing"</span><span class="op">)</span>,
           inc <span class="op">=</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">A</span>, ext_seq <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_unif</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_lbm_unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_fun</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="st">"dotted"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_fun</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="st">"dotted"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_fun</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="st">"dotted"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_fun</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="st">"dotted"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_fun</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="st">"dotted"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Uniform"</span><span class="op">)</span>
<span class="va">pu</span></code></pre></div>
<p><img src="topological-analysis_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>Computing the robustness for other extinctions sequence gives complementary information on the network. For example extinctions by decreasing or increasing number of connections may give an information about a worst-case and best-case scenario.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rob_emp_dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">hostparasite</span>, ext_seq <span class="op">=</span> <span class="st">"decreasing"</span><span class="op">)</span>
<span class="va">rob_emp_inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">hostparasite</span>, ext_seq <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span>
<span class="va">rob_emp_dec</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.5798813</span>
<span class="va">rob_emp_inc</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.8918519</span></code></pre></div>
<p>The above method is very sensitive to the network sampling, in particular for increasing connection. One way to counter that is to consider that the order of extinction is a function of the degree, for example it might depends linearly on it.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rob_emp_dec_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">hostparasite</span>, ext_seq <span class="op">=</span> <span class="st">"decreasing"</span>, 
                                  method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span>
<span class="va">rob_emp_inc_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">hostparasite</span>, ext_seq <span class="op">=</span> <span class="st">"increasing"</span>, 
                                  method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span>
<span class="va">rob_emp_dec_lin</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.6959592</span>
<span class="va">rob_emp_inc_lin</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.8458784</span></code></pre></div>
<p>As we can see the obtained robustness values are less extreme and closer to the one of a uniform primary extinctions distribution.</p>
<p>Using the LBM, we can compute a robustness where the extinction distribution is dependent of the block memberships of the primary species. For example, by ordering blocks by their connection probabilities, and extinguishing species base on this order, we obtain:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rob_lbm_dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lbm_param</span>, ext_seq <span class="op">=</span> <span class="st">"decreasing"</span><span class="op">)</span><span class="op">)</span>
<span class="va">rob_lbm_inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lbm_param</span>, ext_seq <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span><span class="op">)</span>
<span class="va">rob_lbm_dec</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.6383963</span>
<span class="va">rob_lbm_inc</span><span class="op">$</span><span class="va">auc</span>
<span class="co">#&gt; [1] 0.9064095</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_lbm_unif</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_unif</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_dec</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_dec_lin</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_inc</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_emp_inc_lin</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_lbm_dec</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rob_lbm_inc</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Robustness of hostparasite"</span><span class="op">)</span></code></pre></div>
<p><img src="topological-analysis_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
</div>
<div id="comparing-the-robustness-of-3-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-the-robustness-of-3-networks" class="anchor"></a>Comparing the robustness of 3 networks</h2>
<p>How robust is the robustness of the host-parasite network compare to the one of the pollination and seed dispersal’s one? As we have seen above, the richness and the connectance of these networks are different and it is difficult to know which part of this difference is due sampling method and effort. Let first analyze the mesoscale structure of the mutualistic networks.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl_param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">pollination</span>, ncores <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd_param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">seeddispersal</span>, ncores <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl_param</span>
<span class="co">#&gt; $con</span>
<span class="co">#&gt;            [,1]      [,2]</span>
<span class="co">#&gt; [1,] 0.21745638 0.2197264</span>
<span class="co">#&gt; [2,] 0.02128773 0.4718378</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $pi</span>
<span class="co">#&gt; [1] 0.3615401 0.6384599</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rho</span>
<span class="co">#&gt; [1] 0.8038735 0.1961265</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nr</span>
<span class="co">#&gt; [1] 17</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nc</span>
<span class="co">#&gt; [1] 51</span></code></pre></div>
<p>For the pollination network, we have <span class="math inline">\(2\)</span> blocks of plants and <span class="math inline">\(2\)</span> block of pollinators. About a third of the plants belong to a block which is equally connected to the whole network. The rest interacts with a high probability with about a fifth of the pollinators and very rarely with the rest of the pollinators.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd_param</span>
<span class="co">#&gt; $con</span>
<span class="co">#&gt;            [,1]       [,2]       [,3]</span>
<span class="co">#&gt; [1,] 0.11544193 0.13851862 0.82679371</span>
<span class="co">#&gt; [2,] 0.27290332 0.01141444 0.07307945</span>
<span class="co">#&gt; [3,] 0.01017275 0.76159403 0.09607779</span>
<span class="co">#&gt; [4,] 0.67676491 0.77581178 0.96824538</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $pi</span>
<span class="co">#&gt; [1] 0.39352244 0.30071493 0.24805831 0.05770433</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rho</span>
<span class="co">#&gt; [1] 0.2642601 0.5232847 0.2124552</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nr</span>
<span class="co">#&gt; [1] 36</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nc</span>
<span class="co">#&gt; [1] 19</span></code></pre></div>
<p>The seed-dispersal networks has a more complex mesoscale structure with <span class="math inline">\(4\)</span> blocks of plants and <span class="math inline">\(3\)</span> blocks of birds. It has a kind of double core structure. We compare the three networks using the LBM robustness.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl_lbm_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="va">pl_param</span><span class="op">)</span>
<span class="va">pl_lbm_dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pl_param</span>, ext_seq <span class="op">=</span> <span class="st">"decreasing"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pl_lbm_inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pl_param</span>, ext_seq <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sd_lbm_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="va">sd_param</span><span class="op">)</span>
<span class="va">sd_lbm_dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sd_param</span>, ext_seq <span class="op">=</span> <span class="st">"decreasing"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sd_lbm_inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">robustness_lbm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sd_param</span>, ext_seq <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Extinction</th>
<th align="right">hostparasite</th>
<th align="right">pollination</th>
<th align="right">seeddispersal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Uniform</td>
<td align="right">0.8083190</td>
<td align="right">0.6055976</td>
<td align="right">0.9207443</td>
</tr>
<tr class="even">
<td align="left">Increasing</td>
<td align="right">0.9064095</td>
<td align="right">0.7173889</td>
<td align="right">0.9624479</td>
</tr>
<tr class="odd">
<td align="left">Decreasing</td>
<td align="right">0.6383963</td>
<td align="right">0.4338048</td>
<td align="right">0.7204255</td>
</tr>
</tbody>
</table>
<p>As we can see, for all three types of robustness, the seed-dispersal is more robust than the host-parasite network. The pollination network being less robust than the other 2. We wish to know which part is due to the difference in the richness and connectance of these networks and which part is due there different structure. For this, we will change the parameters of those networks, using the <code><a href="../reference/compare_robustness.html">compare_robustness()</a></code> function and compute a new robustness, where the difference depends solely on the mesoscale structure of these networks. For this, we normalize the networks so they have the connectance of the sparsest network (<code>pollination</code>) and the richness of the richest network (<code>seeddispersal</code> for row species and <code>pollination</code> for column species).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">comp_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_robustness.html">compare_robustness</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lbm_param</span>, <span class="va">pl_param</span>, <span class="va">sd_param</span><span class="op">)</span>, 
                   dens <span class="op">=</span> <span class="fl">.148</span>, new_nr <span class="op">=</span> <span class="fl">36</span>, new_nc <span class="op">=</span> <span class="fl">51</span><span class="op">)</span>
<span class="va">comp_inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_robustness.html">compare_robustness</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lbm_param</span>, <span class="va">pl_param</span>, <span class="va">sd_param</span><span class="op">)</span>, 
                   dens <span class="op">=</span> <span class="fl">.148</span>, new_nr <span class="op">=</span> <span class="fl">36</span>, new_nc <span class="op">=</span> <span class="fl">51</span>, ext_seq <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span>
<span class="va">comp_dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_robustness.html">compare_robustness</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lbm_param</span>, <span class="va">pl_param</span>, <span class="va">sd_param</span><span class="op">)</span>, 
                   dens <span class="op">=</span> <span class="fl">.148</span>, new_nr <span class="op">=</span> <span class="fl">36</span>, new_nc <span class="op">=</span> <span class="fl">51</span>, ext_seq <span class="op">=</span> <span class="st">"decreasing"</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Extinction</th>
<th align="right">hostparasite</th>
<th align="right">pollination</th>
<th align="right">seeddispersal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Uniform</td>
<td align="right">0.7222423</td>
<td align="right">0.7768652</td>
<td align="right">0.8225664</td>
</tr>
<tr class="even">
<td align="left">Increasing</td>
<td align="right">0.8298738</td>
<td align="right">0.8819160</td>
<td align="right">0.8793888</td>
</tr>
<tr class="odd">
<td align="left">Decreasing</td>
<td align="right">0.5622294</td>
<td align="right">0.5469495</td>
<td align="right">0.6139946</td>
</tr>
</tbody>
</table>
<p>While the robustness of <code>seeddispersal</code> is still the highest, we can see that <code>pollination</code> now have a higher robustness than <code>hostparasite</code>. Hence the lack of robustness of <code>pollination</code> compared to the other network was mainly due to its lower connectance and plant richness, rather than its particular mesoscale structure.</p>
</div>
</div>
<div id="comparing-the-influence-of-mesoscale-structure-on-robustness" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-the-influence-of-mesoscale-structure-on-robustness" class="anchor"></a>Comparing the influence of mesoscale structure on robustness</h1>
<p>We will compare set of networks that all have the same number of rows, columns and connectance. We select those numbers such that the upper bound for the robustness with uniform extinctions is approximately 0.5.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fl">.0156</span>
<span class="va">nr</span> <span class="op">&lt;-</span>  <span class="fl">100</span>
<span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">rob_er</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auc_robustness_lbm.html">auc_robustness_lbm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">dens</span>, <span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span>
<span class="va">rob_er</span>
<span class="co">#&gt; [1] 0.4999551</span></code></pre></div>
<p>We will consider 2 blocks of row species and 2 blocks of column species. The parameters will be as followed:</p>
<ul>
<li><p><span class="math inline">\(\pi\)</span> The row blocks parameter will be set to [1/4, 3/4]</p></li>
<li><p><span class="math inline">\(\rho\)</span> The column blocks parameter will vary</p></li>
<li>
<p><strong>con</strong> The connectivity parameters between blocks will be set to represent 2 classic topologies:</p>
<ul>
<li>
<strong>Modular</strong> the shape of the connectivity matrix will be as follows:</li>
</ul>
</li>
</ul>
<table class="table"><tbody>
<tr class="odd">
<td align="left">a</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">a</td>
</tr>
</tbody></table>
<ul>
<li><ul>
<li>
<strong>Nested</strong> A classic Core-periphery with or without strong connection between the core and the periphery depending on the parameters:</li>
</ul></li>
</ul>
<table class="table"><tbody>
<tr class="odd">
<td align="left">a</td>
<td align="left">a</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="left">1</td>
</tr>
</tbody></table>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">robust_topology</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">1.5</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, by <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">i</span><span class="op">*</span><span class="fl">.05</span>, <span class="op">(</span><span class="fl">20</span><span class="op">-</span><span class="va">i</span><span class="op">)</span><span class="op">*</span><span class="fl">.05</span><span class="op">)</span>
    <span class="va">list_con_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span> <span class="va">eps</span>,
                            <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span>
                              <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>con <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">j</span>, <span class="fl">1</span>,
                                                  <span class="fl">1</span>, <span class="va">j</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                                   pi <span class="op">=</span> <span class="va">pi</span>,
                                   rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
    <span class="va">rob_mod</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dfc</a></span><span class="op">(</span>
      .x <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"uniform"</span>, <span class="st">"increasing"</span>, <span class="st">"decreasing"</span><span class="op">)</span><span class="op">)</span>, 
      .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/compare_robustness.html">compare_robustness</a></span><span class="op">(</span>list_param <span class="op">=</span> <span class="va">list_con_mod</span>, 
                                  dens <span class="op">=</span> <span class="va">dens</span>, 
                                  new_nr <span class="op">=</span> <span class="va">nr</span>, 
                                  new_nc <span class="op">=</span> <span class="va">nc</span>, 
                                  ext_seq <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Topology <span class="op">=</span> <span class="st">"Modular"</span>, 
                    rho <span class="op">=</span> <span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, 
                    j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span><span class="op">)</span>
    <span class="va">list_con_nest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span> <span class="va">eps</span>,
                             <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span>
                               <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>con <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">j</span>, <span class="va">j</span>,
                                                   <span class="va">j</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                                    pi <span class="op">=</span> <span class="va">pi</span>,
                                    rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
    <span class="va">rob_nest</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dfc</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"uniform"</span>, <span class="st">"increasing"</span>, <span class="st">"decreasing"</span><span class="op">)</span><span class="op">)</span>, 
                               .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> 
                                 <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/compare_robustness.html">compare_robustness</a></span><span class="op">(</span>list_param <span class="op">=</span> <span class="va">list_con_nest</span>, 
                                                           dens <span class="op">=</span> <span class="va">dens</span>, 
                                                           new_nr <span class="op">=</span> <span class="va">nr</span>, 
                                                           new_nc <span class="op">=</span> <span class="va">nc</span>, 
                                                           ext_seq <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Topology <span class="op">=</span> <span class="st">"Core-Periphery"</span>, 
                    rho <span class="op">=</span> <span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, 
                    j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span><span class="op">)</span>
    <span class="va">robust_topology</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">robust_topology</span>, <span class="va">rob_mod</span>, <span class="va">rob_nest</span><span class="op">)</span>
  <span class="op">}</span></code></pre></div>
<p>We print a heatmap going from blue (least robust), to white (same robustness than a network with no mesoscale structure), to red (more robust than a network with no structure).</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prt</span> <span class="op">&lt;-</span> <span class="va">robust_topology</span> <span class="op">%&gt;%</span>
<span class="co">#  rename(Uniform = uniform, Increasing = increasing, Decreasing = decreasing) +</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"decreasing"</span>,<span class="st">"uniform"</span>, <span class="st">"increasing"</span><span class="op">)</span>, 
                      names_to <span class="op">=</span> <span class="st">"Extinction"</span>, 
                      values_to <span class="op">=</span> <span class="st">"Robustness"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>Extinction <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span>
    <span class="fu">case_when</span><span class="op">(</span><span class="va">Extinction</span> <span class="op">==</span> <span class="st">"decreasing"</span> <span class="op">~</span> <span class="st">"Decreasing"</span>,
              <span class="va">Extinction</span> <span class="op">==</span> <span class="st">"uniform"</span> <span class="op">~</span> <span class="st">"Uniform"</span>,
              <span class="va">Extinction</span> <span class="op">==</span> <span class="st">"increasing"</span> <span class="op">~</span> <span class="st">"Increasing"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">j</span>, y <span class="op">=</span> <span class="va">rho</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Robustness</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">Topology</span>  <span class="op">~</span> <span class="va">Extinction</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_gradient2</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, 
                                midpoint <span class="op">=</span> <span class="va">rob_er</span>, 
                                <span class="fu">guide_colorbar</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"R"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">15</span>, y <span class="op">=</span> <span class="fl">.5</span>, geom <span class="op">=</span> <span class="st">"point"</span>, col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">15</span>, y <span class="op">=</span> <span class="fl">.55</span>, geom <span class="op">=</span> <span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"ER"</span>,
                    col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">15</span>, <span class="fl">22</span>, <span class="fl">30</span><span class="op">)</span>, 
                              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span>, base_line_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># df_shape &lt;- data.frame(</span>
<span class="co">#   x = c(1, 1, 29, 29, 1, 14),</span>
<span class="co">#   y = c(.05, .05, .05, .5, .95, .05),</span>
<span class="co">#   button = c("a", "d", "b","e", "c", "f"),</span>
<span class="co">#   Topology = rep(c("Core-Periphery", "Modular"), 3),</span>
<span class="co">#   Extinction = c(rep("Decreasing", 2), rep("Increasing", 2), rep("Uniform", 2)))</span>
<span class="va">df_shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>  , <span class="fl">29</span> , <span class="fl">29</span>,   <span class="fl">29</span>,  <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.85</span>, <span class="fl">.05</span>, <span class="fl">.35</span>, <span class="fl">.95</span>, <span class="fl">.6</span>, <span class="fl">.4</span><span class="op">)</span>,
  button <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15L</span>, <span class="fl">17L</span>, <span class="fl">18L</span>, <span class="fl">0L</span>, <span class="fl">2L</span>, <span class="fl">5L</span><span class="op">)</span>,<span class="co">#,</span>
  Topology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Core-Periphery"</span>, <span class="st">"Modular"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#  Extinction = c(rep("Decreasing", 2), rep("Increasing", 2), rep("Uniform", 2)))</span>
<span class="va">prt</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_shape</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, shape <span class="op">=</span> <span class="va">button</span><span class="op">)</span>, 
                 size <span class="op">=</span> <span class="fl">4</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_shape_identity</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p><img src="topological-analysis_files/figure-html/print_topo-1.png" width="576"></p>
<!-- ```{r print_topo} -->
<!-- var_er <- var_auc_unif_lbm(matrix(.0156, 1, 1), 1, 1, 100, 100) -->
<!-- prtpres <- robust_topology %>% -->
<!-- #  rename(Uniform = uniform, Increasing = increasing, Decreasing = decreasing) + -->
<!--   tidyr::pivot_longer(cols = c("uniform", "increasing", "decreasing"),  -->
<!--                       names_to = "Extinction",  -->
<!--                       values_to = "Robustness") %>% -->
<!--   mutate(Extinction = as.factor(case_when(Extinction == "uniform" ~ "Uniform", -->
<!--                                 Extinction == "increasing" ~ "Increasing", -->
<!--                                 Extinction == "decreasing" ~ "Decreasing"))) %>%  -->
<!--   filter(Extinction == "Uniform") %>%  -->
<!--   ggplot(ggplot2::aes(x = j, y = rho)) + -->
<!--   geom_tile(ggplot2::aes(fill = Robustness)) + -->
<!--   facet_wrap(~ Topology) + -->
<!--   scale_fill_gradient2(low = "blue", high = "red",  -->
<!--                                 midpoint = rob_er - sqrt(var_er),  -->
<!--                                 guide_colorbar(title = "R")) + -->
<!--   annotate(x = 15, y = .5, geom = "point", col = "black", size = 4) + -->
<!--   annotate(x = 15, y = .55, geom = "text", label = "ER", -->
<!--                     col = "black", size = 3) + -->
<!--   scale_x_continuous(breaks = c(0, 7, 15, 22, 30),  -->
<!--                               labels = c(1/8, 1/4, 1, 4, 8)) + -->
<!--   coord_fixed(ratio = 30) + -->
<!--   theme_bw(base_size = 15, base_line_size = 0) -->
<!-- # df_shape <- data.frame( -->
<!-- #   x = c(1, 1, 29, 29, 1, 14), -->
<!-- #   y = c(.05, .05, .05, .5, .95, .05), -->
<!-- #   button = c("a", "d", "b","e", "c", "f"), -->
<!-- #   Topology = rep(c("Core-Periphery", "Modular"), 3), -->
<!-- #   Extinction = c(rep("Decreasing", 2), rep("Increasing", 2), rep("Uniform", 2))) -->
<!-- df_shape <- data.frame( -->
<!--   x = c(29, 1, 15), -->
<!--   y = c( .35, .75, .05), -->
<!--   button = c(15L, 17L, 18L))#, -->
<!-- #  Topology = rep(c("Core-Periphery", "Modular"), 3), -->
<!-- #  Extinction = c(rep("Decreasing", 2), rep("Increasing", 2), rep("Uniform", 2))) -->
<!-- prtpres + geom_point(data = df_shape, mapping = aes(x = x, y = y, shape = button),  -->
<!--                  size = 5, show.legend = FALSE)+ -->
<!--   scale_shape_identity()  -->
<!-- ``` -->
<div id="influence-of-the-mesoscale-structure-on-the-variability-of-the-robustness" class="section level2">
<h2 class="hasAnchor">
<a href="#influence-of-the-mesoscale-structure-on-the-variability-of-the-robustness" class="anchor"></a>Influence of the mesoscale structure on the variability of the robustness</h2>
<p>Finally, we will try to figure out how the variability of the robustness depends on the mesoscale structure of the network and which part of it comes from the variability in connectance and size of blocks of the network by restricting ourselves to networks that has the same block proportions and number of connections between blocks as expected.</p>
<p>We restrict ourselves to 3 classic topologies: ER (no mesoscale structure), modular (assortative communities) and core-periphery. We observe that the variability increase with mesoscale structure complexity and that the main part of it is due to the variance in block proportions and number of connections between blocks.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"res_gnp.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">n_iter</span> <span class="op">&lt;-</span> <span class="fl">300</span>
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.9</span><span class="op">)</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">.8</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.4</span>, <span class="fl">.4</span>, <span class="fl">.1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">con</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">pi</span><span class="op">%*%</span><span class="va">con</span><span class="op">%*%</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">nr</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_lbm.html">simulate_lbm</a></span><span class="op">(</span>nr <span class="op">=</span> <span class="va">nr</span>, nc <span class="op">=</span> <span class="va">nc</span>, pi <span class="op">=</span> <span class="va">pi</span>, rho <span class="op">=</span> <span class="va">rho</span>, con <span class="op">=</span> <span class="va">con</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cp"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_cp</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  
  <span class="va">n_iter</span> <span class="op">&lt;-</span> <span class="fl">300</span>
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="va">nr</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_lbm.html">simulate_lbm</a></span><span class="op">(</span>nr <span class="op">=</span> <span class="va">nr</span>, nc <span class="op">=</span> <span class="va">nc</span>, pi <span class="op">=</span> <span class="va">pi</span>, rho <span class="op">=</span> <span class="va">rho</span>, con <span class="op">=</span> <span class="va">con</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"er"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_er</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  
  <span class="va">pi</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span><span class="op">)</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.1</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">con</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">pi</span><span class="op">%*%</span><span class="va">con</span><span class="op">%*%</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_lbm.html">simulate_lbm</a></span><span class="op">(</span>nr <span class="op">=</span> <span class="va">nr</span>, nc <span class="op">=</span> <span class="va">nc</span>, pi <span class="op">=</span> <span class="va">pi</span>, rho <span class="op">=</span> <span class="va">rho</span>, con <span class="op">=</span> <span class="va">con</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"mod"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_mod</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  <span class="va">res_gnp</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res_cp</span>, <span class="va">res_mod</span>, <span class="va">res_er</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">res_gnp</span>, <span class="st">"res_gnp.rds"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">res_gnp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"res_gnp.rds"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"res_gnm.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">n_iter</span> <span class="op">&lt;-</span> <span class="fl">300</span>
  <span class="va">nr</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.9</span><span class="op">)</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">.8</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.4</span>, <span class="fl">.4</span>, <span class="fl">.1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">con</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">pi</span><span class="op">%*%</span><span class="va">con</span><span class="op">%*%</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="va">nr</span> <span class="op">*</span> <span class="va">pi</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="va">nc</span> <span class="op">*</span> <span class="va">rho</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">rho</span><span class="op">)</span> <span class="op">*</span> <span class="va">con</span><span class="op">)</span>
  
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_lbm.html">simulate_lbm</a></span><span class="op">(</span>nr <span class="op">=</span> <span class="va">nr</span>, nc <span class="op">=</span> <span class="va">nc</span>, pi <span class="op">=</span> <span class="va">pi</span>, rho <span class="op">=</span> <span class="va">rho</span>, con <span class="op">=</span> <span class="va">con</span>, method <span class="op">=</span> <span class="st">"gnm"</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cp"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_cp_gnm</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="va">nr</span> <span class="op">*</span> <span class="va">pi</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="va">nc</span> <span class="op">*</span> <span class="va">rho</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">rho</span><span class="op">)</span> <span class="op">*</span> <span class="va">con</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_lbm.html">simulate_lbm</a></span><span class="op">(</span>nr <span class="op">=</span> <span class="va">nr</span>, nc <span class="op">=</span> <span class="va">nc</span>, pi <span class="op">=</span> <span class="va">pi</span>, rho <span class="op">=</span> <span class="va">rho</span>, con <span class="op">=</span> <span class="va">con</span>, method <span class="op">=</span> <span class="st">"gnm"</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"er"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_er_gnm</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  
  <span class="va">pi</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span><span class="op">)</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.1</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">con</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">pi</span><span class="op">%*%</span><span class="va">con</span><span class="op">%*%</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="va">nr</span> <span class="op">*</span> <span class="va">pi</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="va">nc</span> <span class="op">*</span> <span class="va">rho</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">rho</span><span class="op">)</span> <span class="op">*</span> <span class="va">con</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_lbm.html">simulate_lbm</a></span><span class="op">(</span>nr <span class="op">=</span> <span class="va">nr</span>, nc <span class="op">=</span> <span class="va">nc</span>, pi <span class="op">=</span> <span class="va">pi</span>, rho <span class="op">=</span> <span class="va">rho</span>, con <span class="op">=</span> <span class="va">con</span>, method <span class="op">=</span> <span class="st">"gnm"</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"mod"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_mod_gnm</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>  
  <span class="va">res_gnm</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res_cp_gnm</span>, <span class="va">res_mod_gnm</span>, <span class="va">res_er_gnm</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">res_gnm</span>, <span class="st">"res_gnm.rds"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">res_gnm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"res_gnm.rds"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"res_block.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">n_iter</span> <span class="op">&lt;-</span> <span class="fl">300</span>
  <span class="va">nr</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.9</span><span class="op">)</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">.8</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.4</span>, <span class="fl">.4</span>, <span class="fl">.1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">con</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">pi</span><span class="op">%*%</span><span class="va">con</span><span class="op">%*%</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">simz</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>
     <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="kw">for</span> <span class="op">(</span><span class="va">q</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">A</span><span class="op">[</span><span class="va">Z</span> <span class="op">==</span> <span class="va">k</span>, <span class="va">W</span> <span class="op">==</span> <span class="va">q</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as_incidence_matrix.html">as_incidence_matrix</a></span><span class="op">(</span>
          <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/sample_bipartite.html">sample_bipartite</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">==</span> <span class="va">k</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">W</span> <span class="op">==</span> <span class="va">q</span><span class="op">)</span>,
                                   type <span class="op">=</span> <span class="st">"gnp"</span>, p <span class="op">=</span> <span class="va">con</span><span class="op">[</span><span class="va">k</span>,<span class="va">q</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
      <span class="op">}</span>
     <span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">Z</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>
  <span class="va">W</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu">simz</span><span class="op">(</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cp"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_cp_block</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  
  <span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="va">Z</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>
  <span class="va">W</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu">simz</span><span class="op">(</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"er"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_er_block</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  
  <span class="va">pi</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span><span class="op">)</span>
  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.1</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">con</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">pi</span><span class="op">%*%</span><span class="va">con</span><span class="op">%*%</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">W</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">rho</span><span class="op">)</span>
  <span class="va">Z</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pbmcapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbmcapply/man/pbmclapply.html">pbmclapply</a></span><span class="op">(</span>
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu">simz</span><span class="op">(</span><span class="op">)</span>
      <span class="va">auc_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_emp.html">robustness_emp</a></span><span class="op">(</span><span class="va">G</span>, nb_iter <span class="op">=</span>  <span class="va">n_iter</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lbm_param.html">get_lbm_param</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span>
      <span class="va">auc_lbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustness_lbm.html">robustness_lbm</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">con</span>, <span class="va">par</span><span class="op">$</span><span class="va">pi</span>, <span class="va">par</span><span class="op">$</span><span class="va">rho</span>, <span class="va">nr</span>, <span class="va">nc</span><span class="op">)</span><span class="op">$</span><span class="va">auc</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"mod"</span>, mc <span class="op">=</span> <span class="va">auc_mc</span>, lbm <span class="op">=</span> <span class="va">auc_lbm</span> <span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fl">8</span>
  <span class="op">)</span>
  <span class="va">res_mod_block</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res</span><span class="op">)</span>  
  <span class="va">res_block</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">res_cp_block</span>, <span class="va">res_mod_block</span>, <span class="va">res_er_block</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">res_block</span>, <span class="st">"res_block.rds"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">res_block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"res_block.rds"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<!-- ```{r} -->
<!-- res_gnm %>%  -->
<!--   mutate(Model = "Microcanonical") %>%  -->
<!--   bind_rows( -->
<!--       res_gnp %>%  -->
<!--       mutate(Model = "Canonical")) %>%  -->
<!--   bind_rows( -->
<!--     res_block %>%  -->
<!--     mutate(Model = "Fixed Blocks")) %>%  -->
<!--   pivot_longer(cols = - c(type, Model), names_to = "Method", values_to = "Robustness") %>%  -->
<!-- #  rename(Topology = type) %>%  -->
<!--   mutate( -->
<!--     Topology = case_when( -->
<!--       type == "cp" ~ "Core-Periphery", -->
<!--       type == "er" ~ "ER", -->
<!--       type == "mod" ~ "Modular" -->
<!--     )) %>%  -->
<!--   filter(Method == "mc") %>%  -->
<!--   ggplot(aes(x = Robustness, fill = Topology, lty = Topology)) + -->
<!--   ggridges::geom_density_ridges(aes(y = Model), alpha = .3) + -->
<!-- #  geom_density(alpha = .2) + -->
<!--   ylab(label = "") + -->
<!-- #  facet_wrap(~ Model) + -->
<!--   theme_minimal(base_size = 15)  -->
<!-- ``` -->
<!-- ```{r compute_gnp} -->
<!-- if (! file.exists("res_gnp_pres.rds")) { -->
<!--   n_iter <- 300 -->
<!--   pi <- c(.25,.75) -->
<!--   rho <- c(.35,.65) -->
<!--   con <- matrix(c(.8, .8, .8, .1), 2, 2) -->
<!--   con <- 0.0156*con/as.vector(pi%*%con%*%rho) -->
<!--   nr <- 100 -->
<!--   nc <- 100 -->
<!--   res <- pbmcapply::pbmclapply( -->
<!--     X = seq(500), -->
<!--     FUN = function(i) { -->
<!--       G <- simulate_lbm(nr = nr, nc = nc, pi = pi, rho = rho, con = con) -->
<!--       auc_mc <- robustness_emp(G$A, nb_iter =  n_iter)$auc -->
<!--       par <- get_lbm_param(G$A) -->
<!--       auc_lbm <- robustness_lbm(par$con, par$pi, par$rho, nr, nc)$auc -->
<!--       return(tibble(type = "cp", mc = auc_mc, lbm = auc_lbm )) -->
<!--     }, mc.cores = 8 -->
<!--   ) -->
<!--   res_cp <- bind_rows(res) -->
<!--   n_iter <- 300 -->
<!--   pi <- 1 -->
<!--   rho <- 1 -->
<!--   con <- matrix(0.0156, 1, 1) -->
<!--   nr <- 100 -->
<!--   nc <- 100 -->
<!--   res <- pbmcapply::pbmclapply( -->
<!--     X = seq(500), -->
<!--     FUN = function(i) { -->
<!--       G <- simulate_lbm(nr = nr, nc = nc, pi = pi, rho = rho, con = con) -->
<!--       auc_mc <- robustness_emp(G$A, nb_iter =  n_iter)$auc -->
<!--       par <- get_lbm_param(G$A) -->
<!--       auc_lbm <- robustness_lbm(par$con, par$pi, par$rho, nr, nc)$auc -->
<!--       return(tibble(type = "er", mc = auc_mc, lbm = auc_lbm )) -->
<!--     }, mc.cores = 8 -->
<!--   ) -->
<!--   res_er <- bind_rows(res) -->
<!--   pi  <- c(.25, .75) -->
<!--   rho <- c(.35, .65) -->
<!--   con <- matrix(c(.8, .1, .1, .8), 2, 2) -->
<!--   con <- 0.0156*con/as.vector(pi%*%con%*%rho) -->
<!--   res <- pbmcapply::pbmclapply( -->
<!--     X = seq(500), -->
<!--     FUN = function(i) { -->
<!--       G <- simulate_lbm(nr = nr, nc = nc, pi = pi, rho = rho, con = con) -->
<!--       auc_mc <- robustness_emp(G$A, nb_iter =  n_iter)$auc -->
<!--       par <- get_lbm_param(G$A) -->
<!--       auc_lbm <- robustness_lbm(par$con, par$pi, par$rho, nr, nc)$auc -->
<!--       return(tibble(type = "mod", mc = auc_mc, lbm = auc_lbm )) -->
<!--     }, mc.cores = 8 -->
<!--   ) -->
<!--   res_mod <- bind_rows(res) -->
<!--   res_gnp_pres <- bind_rows(res_cp, res_mod, res_er) -->
<!--   saveRDS(res_gnp, "res_gnp_pres.rds") -->
<!-- } else { -->
<!--   res_gnp_pres <- readRDS("res_gnp_pres.rds") -->
<!-- } -->
<!-- ``` -->
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_gnp</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"Canonical"</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">Model</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Method"</span>, values_to <span class="op">=</span> <span class="st">"Robustness"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
<span class="co">#  rename(Topology = type) %&gt;% </span>
  <span class="fu">mutate</span><span class="op">(</span>
    Topology <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">type</span> <span class="op">==</span> <span class="st">"cp"</span> <span class="op">~</span> <span class="st">"Core-Periphery"</span>,
      <span class="va">type</span> <span class="op">==</span> <span class="st">"er"</span> <span class="op">~</span> <span class="st">"ER"</span>,
      <span class="va">type</span> <span class="op">==</span> <span class="st">"mod"</span> <span class="op">~</span> <span class="st">"Modular"</span>
    <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Method</span> <span class="op">==</span> <span class="st">"mc"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Robustness</span>, fill <span class="op">=</span> <span class="va">Topology</span>, lty <span class="op">=</span> <span class="va">Topology</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
<span class="co">#  ggridges::geom_density_ridges(aes(y = Model), alpha = .3) +</span>
<span class="co">#  geom_density(alpha = .2) +</span>
  <span class="fu">ylab</span><span class="op">(</span>label <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
<span class="co">#  facet_wrap(~ Model) +</span>
  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> </code></pre></div>
<p><img src="topological-analysis_files/figure-html/unnamed-chunk-26-1.png" width="576"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Saint-Clair Chabert-Liddell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
